services:
  - mongodb
before_install:
  - sudo apt-get update -qq
  - sudo apt-get install -y lua5.2 liblua5.2-dev libboost-filesystem-dev libboost-filesystem-dev libboost-thread-dev
  - git clone https://github.com/mongodb/mongo-cxx-driver.git
  - cd mongo-cxx-driver && sudo scons --prefix=/usr install-mongoclient && cd -
  - wget https://github.com/moai/luamongo/archive/v0.4.1.tar.gz
  - tar zxvf v0.4.1.tar.gz
  - cd luamongo-0.4.1 && make && sudo mkdir -p /usr/lib/lua/5.2 && sudo cp mongo.so /usr/lib/lua/5.2 && cd -
  - ssh-keygen -b 2048 -f /home/travis/.ssh/id_rsa -t rsa -q -N ""
  - cp ~/.ssh/id_rsa.pub ~/.ssh/authorized_keys
language: lua
script: ./test.sh
